[{"name":"app.r","content":"# Load required libraries\nlibrary(shiny)\nlibrary(dplyr)\n\n# Define trivia questions and answers\ntrivia_questions <- list(\n  list(\n    question = \"What is the capital of France?\",\n    correct_answer = \"Paris\"\n  ),\n  list(\n    question = \"Who painted the Mona Lisa?\",\n    correct_answer = \"Leonardo da Vinci\"\n  ),\n  list(\n    question = \"What is the largest planet in our solar system?\",\n    correct_answer = \"Jupiter\"\n  ),\n  list(\n    question = \"In which year did World War II end?\",\n    correct_answer = \"1945\"\n  ),\n  list(\n    question = \"What is the chemical symbol for gold?\",\n    correct_answer = \"Au\"\n  )\n)\n\n# UI\nui <- fluidPage(\n  titlePanel(\"Trivia Curiosity Experiment\"),\n  \n  # Main panel for displaying the experiment stages\n  mainPanel(\n    width = 12,\n    \n    # Experimental stages\n    uiOutput(\"experiment_stage\"),\n    \n    # Results and answers display\n    uiOutput(\"results_display\")\n  )\n)\n\n# Server\nserver <- function(input, output, session) {\n  # Reactive values to track experiment state\n  rv <- reactiveValues(\n    current_question_index = 1,\n    results = data.frame(\n      Question = character(),\n      UserAnswer = character(),\n      CorrectAnswer = character(),\n      Confidence = numeric(),\n      Curiosity = numeric(),\n      stringsAsFactors = FALSE\n    ),\n    all_answers_submitted = FALSE\n  )\n  \n  # Dynamic UI for experiment stages\n  output$experiment_stage <- renderUI({\n    # If all questions haven't been answered, show current question\n    if (!rv$all_answers_submitted) {\n      tagList(\n        # Question display\n        h3(trivia_questions[[rv$current_question_index]]$question),\n        \n        # User answer input\n        textInput(\"user_answer\", \"Your Answer\"),\n        \n        # Confidence slider\n        sliderInput(\"confidence\", \n                    \"How confident are you? (1 = Not confident, 5 = Very confident)\", \n                    min = 1, \n                    max = 5, \n                    value = 3),\n        \n        # Curiosity slider\n        sliderInput(\"curiosity\", \n                    \"How curious are you to know the correct answer? (1 = Not curious, 5 = Very curious)\", \n                    min = 1, \n                    max = 5, \n                    value = 3),\n        \n        # Next button\n        actionButton(\"next_trial\", \n                     if(rv$current_question_index < length(trivia_questions)) \n                       \"Next Question\" \n                     else \"Submit All Answers\")\n      )\n    }\n  })\n  \n  # Next trial handler\n  observeEvent(input$next_trial, {\n    # Validate that answer is not empty\n    req(input$user_answer)\n    \n    # Add current trial to results\n    new_row <- data.frame(\n      Question = trivia_questions[[rv$current_question_index]]$question,\n      UserAnswer = input$user_answer,\n      CorrectAnswer = trivia_questions[[rv$current_question_index]]$correct_answer,\n      Confidence = input$confidence,\n      Curiosity = input$curiosity\n    )\n    \n    rv$results <- rbind(rv$results, new_row)\n    \n    # Move to next question or mark as completed\n    if(rv$current_question_index < length(trivia_questions)) {\n      rv$current_question_index <- rv$current_question_index + 1\n      \n      # Reset input fields\n      updateTextInput(session, \"user_answer\", value = \"\")\n      updateSliderInput(session, \"confidence\", value = 3)\n      updateSliderInput(session, \"curiosity\", value = 3)\n    } else {\n      # All questions submitted\n      rv$all_answers_submitted <- TRUE\n    }\n  })\n  \n  # Results and answers display\n  output$results_display <- renderUI({\n    req(rv$all_answers_submitted)\n    \n    tagList(\n      h3(\"Your Results\"),\n      \n      # Results table\n      div(\n        style = \"margin-bottom: 20px;\",\n        tableOutput(\"final_results_table\")\n      ),\n      \n      # Correct Answers\n      h3(\"Correct Answers\"),\n      div(\n        lapply(1:length(trivia_questions), function(i) {\n          div(\n            tags$strong(paste(\"Q\", i, \": \", trivia_questions[[i]]$question)),\n            p(paste(\"Correct Answer:\", trivia_questions[[i]]$correct_answer))\n          )\n        })\n      )\n    )\n  })\n  \n  # Render final results table\n  output$final_results_table <- renderTable({\n    req(rv$all_answers_submitted)\n    rv$results\n  })\n}\n\n# Create the Shiny app\nshinyApp(ui, server)\n","type":"text"}]
